bundle:
  name: databricks_cicd_bundle

workspace:
  root_path: /Workspace/main/databricks_cicd/${bundle.environment}

artifacts:
  default:
    path: .
    exclude:
      - .github/**
      - bundle_config/**
      - .git/**
      - README.md

environments:
  dev:
    default: true
    workspace:
      root_path: /Workspace/main/databricks_cicd/dev
    resources:
      jobs:
        main_job:
          name: "Main Job (Dev)"
          job_clusters:
            - job_cluster_key: dev_cluster
              new_cluster:
                spark_version: 14.3.x-scala2.12
                node_type_id: Standard_D3_v2
                num_workers: 2
          tasks:
            - task_key: notebook_task
              notebook_task:
                notebook_path: /Workspace/main/dev/databricks_cicd/Notebooks/testNotebook
              job_cluster_key: dev_cluster

      pipelines:
        dlt_pipeline:
          name: "DLT Pipeline (Dev)"
          development: true
          continuous: true
          clusters:
            - label: default
              num_workers: 2
          libraries:
            - notebook: /Workspace/main/databricks_cicd/dev/dlt/pipeline_notebook

  uat:
    workspace:
      root_path: /Workspace/main/databricks_cicd/uat
    resources:
      jobs:
        main_job:
          name: "Main Job (Uat)"
          job_clusters:
            - job_cluster_key: uat_cluster
              new_cluster:
                spark_version: 14.3.x-scala2.12
                node_type_id: Standard_D3_v2
                num_workers: 2
          tasks:
            - task_key: notebook_task
              notebook_task:
                notebook_path: /Workspace/main/dev/databricks_cicd/Notebooks/
              job_cluster_key: uat_cluster

      pipelines:
        dlt_pipeline:
          name: "DLT Pipeline (Uat)"
          development: true
          continuous: true
          clusters:
            - label: default
              num_workers: 2
          libraries:
            - notebook: /Workspace/main/databricks_cicd/uat/dlt/pipeline_notebook

  prod:
    workspace:
      root_path: /Workspace/main/databricks_cicd/prod
    resources:
      jobs:
        main_job:
          name: "Main Job (Prod)"
          job_clusters:
            - job_cluster_key: prod_cluster
              new_cluster:
                spark_version: 14.3.x-scala2.12
                node_type_id: Standard_D3_v2
                num_workers: 2
          tasks:
            - task_key: notebook_task
              notebook_task:
                notebook_path: /Workspace/main/prod/databricks_cicd/Notebooks/
              job_cluster_key: prod_cluster

      pipelines:
        dlt_pipeline:
          name: "DLT Pipeline (Prod)"
          development: false
          continuous: true
          clusters:
            - label: default
              num_workers: 2
          libraries:
            - notebook: /Workspace/main/databricks_cicd/prod/dlt/pipeline_notebook
